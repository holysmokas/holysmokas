import"./modulepreload-polyfill-B5Qt9EMX.js";import{o as y,s as w,a as d,b as h,c as p,u as E,d as g,e as b,E as C}from"./config-Bhgf-sej.js";/* empty css              */let f=!1;y(d,e=>{const o=window.location.pathname;f||(e&&o.includes("login.html")?window.location.href="./dashboard.html":!e&&o.includes("dashboard.html")&&(window.location.href="./login.html"))});async function P(e){try{(await(await fetch(C.claimProjects,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e.uid,email:e.email})})).json()).success&&console.log("âœ… Projects claimed successfully")}catch(o){console.error("Error claiming projects:",o)}}window.handleLogin=async function(e){e.preventDefault();const o=e.target,c=o.email.value,r=o.password.value,a=document.getElementById("loginBtn");a.disabled=!0,a.textContent="Signing In...";try{const n=(await w(d,c,r)).user;if(!n.emailVerified){l("warning","Email Not Verified","Please verify your email before logging in. Check your inbox for the verification link.",[{text:"Resend Verification Email",action:()=>{I(n)}},{text:"Close",action:closeAuthModal,primary:!0}]),await h(d),a.disabled=!1,a.textContent="Sign In";return}console.log("Login successful:",n.email),await P(n),l("success","Login Successful!","Redirecting to your dashboard..."),setTimeout(()=>{window.location.href="./dashboard.html"},1e3)}catch(t){console.error("Login error:",t);let n="Login failed. Please try again.";t.code==="auth/invalid-credential"||t.code==="auth/wrong-password"?n="Invalid email or password. Please check your credentials.":t.code==="auth/user-not-found"?n="No account found with this email address.":t.code==="auth/too-many-requests"?n="Too many failed login attempts. Please try again later.":t.code==="auth/network-request-failed"?n="Network error. Please check your internet connection.":t.code==="auth/invalid-email"&&(n="Please enter a valid email address."),l("error","Login Failed",n),a.disabled=!1,a.textContent="Sign In"}};window.handleLogout=async function(){try{await h(d),console.log("Logout successful"),window.location.href="./login.html"}catch(e){console.error("Logout error:",e),l("error","Logout Error","Error logging out. Please try again.")}};function l(e,o,c,r=null){const a=document.getElementById("authModal"),t=document.getElementById("authIcon"),n=document.getElementById("authTitle"),s=document.getElementById("authMessage"),i=document.getElementById("authModalButtons");a&&(e==="success"?(t.textContent="âœ“",t.style.background="var(--secondary)"):e==="error"?(t.textContent="âœ•",t.style.background="#ef4444"):e==="warning"&&(t.textContent="âš ",t.style.background="#f59e0b"),n.textContent=o,s.textContent=c,r&&i?(i.innerHTML="",r.forEach(u=>{const m=document.createElement("button");m.textContent=u.text,m.className=u.primary?"btn btn-primary":"btn btn-secondary",m.onclick=u.action,m.style.margin="0 0.5rem",i.appendChild(m)})):i&&(i.innerHTML='<button class="btn btn-primary" onclick="closeAuthModal()">Close</button>'),a.classList.add("show"))}window.closeAuthModal=function(){const e=document.getElementById("authModal");e&&e.classList.remove("show")};window.handleRegister=async function(e){e.preventDefault();const o=e.target,c=o.name.value,r=o.email.value,a=o.password.value,t=document.getElementById("registerBtn");if(a.length<6){l("error","Validation Error","Password must be at least 6 characters long.");return}t.disabled=!0,t.textContent="Creating Account...",f=!0;try{const s=(await p(d,r,a)).user;console.log("Account created:",s.email),await E(s,{displayName:c});const i={url:window.location.origin+"/login.html",handleCodeInApp:!1};await g(s,i),console.log("Verification email sent to:",r),await h(d),await new Promise(u=>setTimeout(u,500)),f=!1,l("success","Account Created Successfully!",`A verification email has been sent to ${r}. Please check your inbox (and spam folder) and click the verification link before logging in.`,[{text:"Go to Login",action:()=>{closeAuthModal(),showLoginForm()},primary:!0}]),o.reset()}catch(n){console.error("Registration error:",n),f=!1;let s="Failed to create account. ";n.code==="auth/email-already-in-use"?s+="An account with this email already exists.":n.code==="auth/weak-password"?s+="Password should be at least 6 characters.":n.code==="auth/invalid-email"?s+="Invalid email address format.":n.code==="auth/operation-not-allowed"?s+="Email/password accounts are not enabled. Please contact support.":s+=n.message,l("error","Registration Failed",s),t.disabled=!1,t.textContent="Create Account"}finally{t.disabled=!1,t.textContent="Create Account"}};async function I(e){try{await g(e),l("success","Verification Email Sent","Please check your inbox for the verification link.")}catch(o){console.error("Error resending verification email:",o),l("error","Error","Failed to resend verification email. Please try again later.")}}window.handlePasswordReset=async function(e=null){let o=e;if(!o){v();return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o)){l("error","Invalid Email","Please enter a valid email address.");return}try{await b(d,o),l("success","Password Reset Email Sent",`A password reset link has been sent to ${o}. Please check your inbox and follow the instructions.`)}catch(r){console.error("Password reset error:",r);let a="Failed to send password reset email.";r.code==="auth/user-not-found"?a="No account found with this email address.":r.code==="auth/invalid-email"?a="Invalid email address format.":r.code==="auth/too-many-requests"?a="Too many requests. Please try again later.":a="An error occurred. Please contact support at (415) 691-7085.",l("error","Password Reset Failed",a)}};function v(){const e=document.getElementById("authModal"),o=document.getElementById("authIcon"),c=document.getElementById("authTitle"),r=document.getElementById("authMessage"),a=document.getElementById("authModalButtons");if(!e)return;o.textContent="ðŸ”’",o.style.background="var(--primary)",c.textContent="Reset Your Password",r.innerHTML=`
        <div style="margin: 1.5rem 0;">
            <input type="email" id="resetEmailInput" placeholder="Enter your email address"
                style="width: 100%; padding: 0.75rem; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem; font-family: inherit;"/>
        </div>
    `,a.innerHTML="";const t=document.createElement("button");t.textContent="Send Reset Link",t.className="btn btn-primary",t.style.margin="0 0.5rem",t.onclick=async()=>{const s=document.getElementById("resetEmailInput"),i=s.value.trim();if(!i){s.style.borderColor="#ef4444";return}closeAuthModal(),await handlePasswordReset(i)};const n=document.createElement("button");n.textContent="Cancel",n.className="btn btn-secondary",n.style.margin="0 0.5rem",n.onclick=closeAuthModal,a.appendChild(t),a.appendChild(n),e.classList.add("show"),setTimeout(()=>{const s=document.getElementById("resetEmailInput");s&&(s.focus(),s.addEventListener("keypress",i=>{i.key==="Enter"&&t.click()}))},100)}document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("authModal");e&&e.addEventListener("click",o=>{(o.target===e||o.target.classList.contains("modal-overlay"))&&closeAuthModal()})});
