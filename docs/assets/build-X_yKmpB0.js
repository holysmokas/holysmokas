var h=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);import{E as f}from"./config-elnU3pxP.js";/* empty css              */var B=h((x,m)=>{const s={sanitizeText:e=>!e||typeof e!="string"?"":e.replace(/[<>]/g,"").replace(/javascript:/gi,"").replace(/on\w+=/gi,"").replace(/data:/gi,"").trim().slice(0,1e3),sanitizeName:e=>!e||typeof e!="string"?"":e.replace(/[<>\"\'`;\\]/g,"").replace(/javascript:/gi,"").replace(/on\w+=/gi,"").trim().slice(0,200),sanitizeEmail:e=>!e||typeof e!="string"?"":e.toLowerCase().replace(/[<>\"\'`;\\]/g,"").trim().slice(0,254),sanitizePhone:e=>!e||typeof e!="string"?"":e.replace(/[^0-9\s\-\(\)\+]/g,"").trim().slice(0,30),sanitizeUrl:e=>{if(!e||typeof e!="string")return"";const t=e.trim();return t.match(/^(javascript|data|vbscript):/i)?"":t.slice(0,2e3)},sanitizeDomain:e=>{if(!e||typeof e!="string")return"";let t=e.toLowerCase().trim();return t=t.replace(/^https?:\/\//,""),t=t.replace(/^www\./,""),t=t.split("/")[0],t=t.replace(/[^a-z0-9\.\-]/g,""),t.slice(0,253)},sanitizeLongText:e=>!e||typeof e!="string"?"":e.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"").replace(/<iframe\b[^<]*(?:(?!<\/iframe>)<[^<]*)*<\/iframe>/gi,"").replace(/javascript:/gi,"").replace(/on\w+=/gi,"").replace(/data:text\/html/gi,"").trim().slice(0,1e4),detectAttack:e=>!e||typeof e!="string"?!1:[/<script/i,/javascript:/i,/on\w+\s*=/i,/union\s+select/i,/;\s*drop\s+table/i,/;\s*delete\s+from/i,/'\s*or\s+'1'\s*=\s*'1/i,/--\s*$/,/\/\*.*\*\//,/\$\{.*\}/,/\{\{.*\}\}/,/<iframe/i,/<embed/i,/<object/i,/expression\s*\(/i].some(a=>a.test(e)),escapeHtml:e=>{if(!e||typeof e!="string")return"";const t=document.createElement("div");return t.textContent=e,t.innerHTML}},i={submissions:{},maxSubmissions:3,windowTime:60*1e3,cooldownTime:300*1e3,canSubmit:(e="build_wizard")=>{const t=Date.now(),a=i.submissions[e];return a?a.cooldownUntil&&t<a.cooldownUntil?!1:t-a.windowStart>i.windowTime?(delete i.submissions[e],!0):a.count<i.maxSubmissions:!0},recordSubmission:(e="build_wizard")=>{const t=Date.now();i.submissions[e]||(i.submissions[e]={count:0,windowStart:t});const a=i.submissions[e];t-a.windowStart>i.windowTime&&(a.count=0,a.windowStart=t),a.count++,a.count>=i.maxSubmissions&&(a.cooldownUntil=t+i.cooldownTime)},getRemainingCooldown:(e="build_wizard")=>{const t=i.submissions[e];if(!t?.cooldownUntil)return 0;const a=t.cooldownUntil-Date.now();return a>0?Math.ceil(a/1e3):0}},d={checks:{},maxChecks:10,windowTime:60*1e3,canCheck:()=>{const e=Date.now(),t=d.checks.domain;return t?e-t.windowStart>d.windowTime?(delete d.checks.domain,!0):t.count<d.maxChecks:!0},recordCheck:()=>{const e=Date.now();d.checks.domain||(d.checks.domain={count:0,windowStart:e});const t=d.checks.domain;e-t.windowStart>d.windowTime&&(t.count=0,t.windowStart=e),t.count++}};window.wizardData={currentStep:1,totalSteps:8,package:null,packagePrice:0,domainOption:null,domain:null,domainPrice:0,domainPricing:null,businessName:"",industry:"",businessDescription:"",tagline:"",designStyle:null,brandColor:"#10b981",inspirationUrl:"",pages:["home"],features:[],logoFile:null,contentReady:"yes",additionalNotes:"",fullName:"",email:"",phone:"",contactMethod:"email"};const E={starter:.5,business:.5,shop:.5},D={starter:"Starter",business:"Business",shop:"Small Shop"},v={modern:"Modern & Minimal",bold:"Bold & Colorful",classic:"Classic & Professional",playful:"Playful & Fun"},b={restaurant:"Restaurant / Food & Beverage",retail:"Retail / E-commerce",professional:"Professional Services",health:"Health & Wellness",beauty:"Beauty & Salon",construction:"Construction / Home Services",realestate:"Real Estate",technology:"Technology / Software",creative:"Creative / Design Agency",education:"Education / Training",nonprofit:"Non-Profit / Organization",other:"Other"};function I(){const e=wizardData.currentStep/wizardData.totalSteps*100;document.getElementById("progressFill").style.width=e+"%",document.getElementById("stepIndicator").textContent=`Step ${wizardData.currentStep} of ${wizardData.totalSteps}`;const t=["Choose Package","Domain Setup","Business Details","Design Style","Pages & Features","Your Assets","Contact Info","Review & Pay"];document.getElementById("stepName").textContent=t[wizardData.currentStep-1]||""}function p(e){document.querySelectorAll(".step-content").forEach(a=>{a.classList.remove("active")});const t=document.getElementById("step"+e);t&&t.classList.add("active"),I()}window.nextStep=function(){if(wizardData.currentStep<wizardData.totalSteps){const e=document.getElementById("wizardCard");e.classList.add("slide-out-left"),setTimeout(()=>{wizardData.currentStep++,p(wizardData.currentStep),e.classList.remove("slide-out-left"),e.classList.add("slide-in-right"),setTimeout(()=>{e.classList.remove("slide-in-right")},400),wizardData.currentStep===8&&S()},400)}};window.prevStep=function(){wizardData.currentStep>1&&(wizardData.currentStep--,p(wizardData.currentStep))};window.selectPackage=function(e){if(wizardData.package=e,wizardData.packagePrice=E[e],document.querySelectorAll(".package-card").forEach(t=>{t.classList.remove("selected")}),document.querySelector(`.package-card[data-package="${e}"]`).classList.add("selected"),document.getElementById("step1Next").disabled=!1,e==="shop"){const t=document.getElementById("shopPage");t&&!t.classList.contains("checked")&&(t.classList.add("checked"),wizardData.pages.includes("shop")||wizardData.pages.push("shop"));const a=document.getElementById("paymentsFeature");a&&!a.classList.contains("checked")&&(a.classList.add("checked"),wizardData.features.includes("payments")||wizardData.features.push("payments"))}};window.selectDomainOption=function(e){wizardData.domainOption=e,document.querySelectorAll(".domain-option").forEach(t=>{t.classList.remove("selected")}),document.querySelector(`.domain-option[data-option="${e}"]`).classList.add("selected"),document.getElementById("newDomainSearch").classList.remove("visible"),document.getElementById("ownDomainInput").classList.remove("visible"),document.getElementById("domainResult").classList.remove("visible"),e==="new"?(document.getElementById("newDomainSearch").classList.add("visible"),document.getElementById("step2Next").disabled=!0):e==="own"&&(document.getElementById("ownDomainInput").classList.add("visible"),document.getElementById("step2Next").disabled=!0)};window.checkDomainAvailability=async function(){const t=document.getElementById("domainSearchInput").value.trim();if(!t)return;if(!d.canCheck()){c(!1,"Too many requests","Please wait a moment before checking another domain.");return}const a=s.sanitizeDomain(t);if(!a){c(!1,"Invalid domain","Please enter a valid domain name.");return}if(s.detectAttack(t)){c(!1,"Invalid characters","Please enter a valid domain name.");return}d.recordCheck();const n=document.getElementById("checkDomainBtn");n.innerHTML='<span class="loading-spinner"></span>',n.disabled=!0;try{const o=await(await fetch(f.checkDomain,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({domain:a})})).json();if(o.available===!0){const l=o.cleanedDomain||a,w=o.pricing?.registrationFee||12.99,g=o.pricing?.setupFee||0,u=o.pricing?.initialCost||w+g,z=o.pricing?.renewalCost||14.99;wizardData.domain=l,wizardData.domainPrice=u,wizardData.domainPricing={initialCost:u,renewalCost:z,registrationFee:w,setupFee:g},c(!0,`${l} is available!`,`$${u.toFixed(2)}/year`),document.getElementById("step2Next").disabled=!1}else c(!1,`${a} is already taken`,"Try a different name or extension"),wizardData.domain=null,wizardData.domainPrice=0,wizardData.domainPricing=null,document.getElementById("step2Next").disabled=!0}catch(r){console.error("Domain check error:",r),c(!1,"Error checking domain","Please try again or contact support")}n.innerHTML="Check",n.disabled=!1};function c(e,t,a){const n=document.getElementById("domainResult"),r=document.getElementById("domainResultIcon"),o=document.getElementById("domainResultTitle"),l=document.getElementById("domainResultDesc");n.className=`domain-result visible ${e?"available":"unavailable"}`,r.textContent=e?"âœ“":"âœ•",o.textContent=t,l.textContent=a}window.validateExistingDomain=function(){const e=document.getElementById("existingDomainInput").value.trim(),t=s.sanitizeDomain(e);t.includes(".")&&t.length>3?(wizardData.domain=t,wizardData.domainPrice=0,wizardData.domainPricing={initialCost:0,renewalCost:0},document.getElementById("step2Next").disabled=!1):(wizardData.domain=null,document.getElementById("step2Next").disabled=!0)};window.validateStep3=function(){const e=document.getElementById("businessName").value.trim(),t=document.getElementById("industry").value,a=document.getElementById("businessDescription").value.trim();wizardData.businessName=s.sanitizeName(e),wizardData.industry=t,wizardData.businessDescription=s.sanitizeLongText(a),wizardData.tagline=s.sanitizeText(document.getElementById("tagline").value.trim());const n=e&&t&&a;document.getElementById("step3Next").disabled=!n};window.selectStyle=function(e){wizardData.designStyle=e,document.querySelectorAll(".style-card").forEach(t=>{t.classList.remove("selected")}),document.querySelector(`.style-card[data-style="${e}"]`).classList.add("selected"),document.getElementById("step4Next").disabled=!1,wizardData.brandColor=document.getElementById("brandColor").value,wizardData.inspirationUrl=s.sanitizeUrl(document.getElementById("inspirationUrl").value)};window.toggleCheckbox=function(e){e.classList.toggle("checked");const t=e.dataset.value,n=e.closest("#pagesGrid")!==null?wizardData.pages:wizardData.features;if(e.classList.contains("checked"))n.includes(t)||n.push(t);else{const r=n.indexOf(t);r>-1&&n.splice(r,1)}};window.handleLogoUpload=function(e){const t=e.target.files[0];if(t){if(!["image/jpeg","image/png","image/gif","image/webp","image/svg+xml"].includes(t.type)){alert("Please upload an image file (JPEG, PNG, GIF, WebP, or SVG)."),e.target.value="";return}if(t.size>5*1024*1024){alert("Logo file must be less than 5MB."),e.target.value="";return}wizardData.logoFile=t;const n=new FileReader;n.onload=function(r){document.getElementById("logoPreviewImg").src=r.target.result,document.getElementById("logoFileName").textContent=t.name,document.getElementById("logoPreview").classList.add("visible"),document.getElementById("logoUploadArea").classList.add("has-file")},n.readAsDataURL(t)}};window.removeLogo=function(){wizardData.logoFile=null,document.getElementById("logoFile").value="",document.getElementById("logoPreview").classList.remove("visible"),document.getElementById("logoUploadArea").classList.remove("has-file")};window.validateStep7=function(){const e=document.getElementById("fullName").value.trim(),t=document.getElementById("email").value.trim(),a=document.getElementById("phone").value.trim();wizardData.fullName=s.sanitizeName(e),wizardData.email=s.sanitizeEmail(t),wizardData.phone=s.sanitizePhone(a),wizardData.contactMethod=document.getElementById("contactMethod").value;const r=e&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)&&a.length>=10;document.getElementById("step7Next").disabled=!r};function S(){wizardData.contentReady=document.getElementById("contentReady").value,wizardData.additionalNotes=s.sanitizeLongText(document.getElementById("additionalNotes").value),document.getElementById("reviewPackage").textContent=`${D[wizardData.package]} - $${wizardData.packagePrice}`,document.getElementById("reviewDomain").textContent=wizardData.domain||"Not specified",wizardData.domainOption==="own"?document.getElementById("reviewDomainCostRow").style.display="none":(document.getElementById("reviewDomainCostRow").style.display="flex",document.getElementById("reviewDomainCost").textContent=`$${wizardData.domainPrice}/year`),document.getElementById("reviewBusinessName").textContent=wizardData.businessName,document.getElementById("reviewIndustry").textContent=b[wizardData.industry]||wizardData.industry,document.getElementById("reviewStyle").textContent=v[wizardData.designStyle]||wizardData.designStyle,document.getElementById("reviewPages").textContent=wizardData.pages.join(", ")||"Home",document.getElementById("reviewName").textContent=wizardData.fullName,document.getElementById("reviewEmail").textContent=wizardData.email;const e=wizardData.packagePrice+wizardData.domainPrice;document.getElementById("reviewTotal").textContent=`$${e.toLocaleString()}`}window.processPayment=async function(){if(!i.canSubmit()){const a=i.getRemainingCooldown();alert(`Too many submission attempts. Please try again in ${a} seconds.`);return}if(!wizardData.package||!wizardData.fullName||!wizardData.email){alert("Please complete all required fields.");return}const e=[wizardData.businessName,wizardData.businessDescription,wizardData.fullName,wizardData.email,wizardData.additionalNotes].join(" ");if(s.detectAttack(e)){alert("Invalid characters detected. Please review your input.");return}const t=document.getElementById("payBtn");t.innerHTML='<span class="loading-spinner"></span> Processing...',t.disabled=!0,i.recordSubmission();try{const a=new FormData;a.append("package",`${D[wizardData.package]} - $${wizardData.packagePrice}`),a.append("packagePrice",wizardData.packagePrice),a.append("category",wizardData.package),a.append("selectedDomain",wizardData.domain||"N/A"),a.append("domainOption",wizardData.domainOption),a.append("isOwnDomain",(wizardData.domainOption==="own").toString()),a.append("domainPricing",JSON.stringify(wizardData.domainPricing)),a.append("businessName",wizardData.businessName),a.append("industry",wizardData.industry),a.append("businessDescription",wizardData.businessDescription),a.append("tagline",wizardData.tagline),a.append("designStyle",wizardData.designStyle),a.append("brandColor",wizardData.brandColor),a.append("inspirationUrl",wizardData.inspirationUrl),a.append("pages",JSON.stringify(wizardData.pages)),a.append("features",JSON.stringify(wizardData.features)),a.append("contentReady",wizardData.contentReady),a.append("additionalNotes",wizardData.additionalNotes),wizardData.logoFile&&a.append("logo",wizardData.logoFile),a.append("name",wizardData.fullName),a.append("email",wizardData.email),a.append("phone",wizardData.phone),a.append("contactMethod",wizardData.contactMethod);const n=wizardData.packagePrice+wizardData.domainPrice;a.append("totalCost",n),a.append("timestamp",new Date().toISOString()),a.append("status","pending_payment"),a.append("source","build_wizard"),console.log("ðŸ“¦ Submitting order:",{package:wizardData.package,domain:wizardData.domain,email:wizardData.email,total:n});const o=await(await fetch(f.createPaymentSession,{method:"POST",body:a})).json();if(o.success)o.requiresPayment===!1?y():o.sessionUrl?window.location.href=o.sessionUrl:y();else throw new Error(o.error||"Payment session creation failed")}catch(a){console.error("Payment error:",a),alert("There was an error processing your request. Please try again or contact us at (415) 691-7085."),t.innerHTML="Pay Now â†’",t.disabled=!1}};function y(){document.getElementById("successEmail").textContent=wizardData.email,document.querySelectorAll(".step-content").forEach(e=>{e.classList.remove("active")}),document.getElementById("stepSuccess").classList.add("active"),document.getElementById("progressFill").style.width="100%",document.getElementById("stepIndicator").textContent="Complete!",document.getElementById("stepName").textContent="Order Confirmed"}document.addEventListener("keydown",e=>{if(e.key==="Enter"&&e.target.tagName!=="TEXTAREA"){const a=document.querySelector(".step-content.active")?.querySelector(".btn-wizard:not(.btn-back):not(:disabled)");a&&!a.id?.includes("check")&&a.click()}});document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("domainSearchInput");e&&e.addEventListener("keydown",t=>{t.key==="Enter"&&(t.preventDefault(),checkDomainAvailability())}),p(1)});typeof m<"u"&&m.exports&&(m.exports={SecurityUtils:s,FormRateLimiter:i,DomainCheckLimiter:d})});export default B();
